(function(){"use strict";var e={3969:function(e,t,a){var o=a(144),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{staticStyle:{"background-color":"#212121","overflow-y":"hidden","font-family":"'Fira Sans', sans-serif"}},[a("Navbar"),a("Tour"),a("v-main",[a("router-view")],1)],1)},i=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("nav",[a("v-toolbar",{staticClass:"black darken-3",attrs:{flat:"",dark:""}},[a("v-toolbar-title",{staticClass:"text-uppercase container",staticStyle:{width:"unset !important"}},[a("span",{staticClass:"font-weight-black",staticStyle:{color:"#f5c10d"}},[e._v("Drought")]),a("span",[e._v("Dash")]),a("span",{staticStyle:{"font-size":"10px"}},[e._v(" BETA")])]),a("v-spacer"),a("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:""},on:{click:e.startTour}},"v-btn",s,!1),o),[a("v-icon",[e._v("mdi-human-male-board")])],1)]}}])},[a("span",[e._v("Dashboard How-To Guide")])]),a("v-dialog",{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",s,!1),o),[a("v-icon",[e._v("mdi-information-outline")])],1)]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"text-h5 py-9"},[e._v(" About Drought Dash ")]),a("v-divider"),a("v-card-text",{staticClass:"py-4"},[e._v(" Drought Dash ")]),a("v-divider")],1)],1)],1)],1)},n=[],l=a(629),c={computed:{...(0,l.rn)({isDual:e=>e.mapContainer.isDual})},data(){return{dialog:!1}},methods:{startTour(){this.isDual&&this.$store.dispatch("toggleDual"),this.$tours["explanatoryTour"].start()}}},d=c,p=a(1001),u=a(3453),m=a.n(u),h=a(3150),g=a(3237),y=a(7118),b=a(7336),f=a(1418),v=a(6428),_=a(9762),S=a(5218),C=a(7921),w=a(9330),x=(0,p.Z)(d,r,n,!1,null,"d8331dc0",null),T=x.exports;m()(x,{VBtn:h.Z,VCard:g.Z,VCardText:y.ZB,VCardTitle:y.EB,VDialog:b.Z,VDivider:f.Z,VIcon:v.Z,VSpacer:_.Z,VToolbar:S.Z,VToolbarTitle:C.qW,VTooltip:w.Z});var E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("WelcomeDialog"),a("v-tour",{attrs:{name:"explanatoryTour",steps:e.isMobile?e.mobileSteps:e.desktopSteps,callbacks:e.callBacks,options:{highlight:!0}},scopedSlots:e._u([{key:"default",fn:function(t){return[a("transition",{attrs:{name:"fade"}},[t.steps[t.currentStep]?a("v-step",{key:t.currentStep,attrs:{step:t.steps[t.currentStep],"previous-step":t.previousStep,"next-step":t.nextStep,stop:t.stop,skip:t.skip,"is-first":t.isFirst,"is-last":t.isLast,finish:t.finish,labels:t.labels,highlight:t.highlight,enableScrolling:t.enableScrolling}},[[a("div",{attrs:{slot:"header"},slot:"header"},[a("b",[e._v("DASHBOARD TOUR ("+e._s(t.currentStep+1)+"/"+e._s(t.steps.length)+")")])])]],2):e._e()],1)]}}])})],1)},k=[],A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{width:"900px"},model:{value:e.welcomeDialog,callback:function(t){e.welcomeDialog=t},expression:"welcomeDialog"}},[a("v-card",{staticClass:"pa-10"},[a("v-card-title",{staticClass:"justify-center"},[a("p",{staticClass:"text-h5 font-weight-light"},[e._v("Welcome to Drought Dash!")]),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.welcomeDialog=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("v-card-text",[a("a",{staticClass:"grey--text text--darken-3 font-weight-medium",staticStyle:{"font-size":"14px"},on:{click:function(t){return e.startTour()}}},[a("v-btn",{attrs:{icon:"",color:"orange"}},[a("v-icon",[e._v("mdi-human-male-board")])],1),e._v(" Take a quick tour guide through the Drought Dash and learn how to navigate within it. "),a("v-btn",{attrs:{icon:"",color:"orange"}},[a("v-icon",[e._v("mdi-arrow-right-bold")])],1)],1)])],1)],1)},$=[],D={name:"WelcomeDialog",data(){return{welcomeDialog:!1}},computed:{...(0,l.rn)({isMobile:e=>e.ui.isMobile})},methods:{startTour(){this.isDual&&(this.$store.dispatch("toggleMapAnalysis"),this.$store.dispatch("toggleDual")),this.$tours["explanatoryTour"].start(),this.welcomeDialog=!1}},mounted(){const e="undefined"===typeof window,t=!e&&JSON.parse(localStorage.getItem("welcomeModalHidden"));t||setTimeout((()=>{this.welcomeDialog=!0}),1e3),e||localStorage.setItem("welcomeModalHidden",!0)}},L=D,M=(0,p.Z)(L,A,$,!1,null,"533b609e",null),R=M.exports;m()(M,{VBtn:h.Z,VCard:g.Z,VCardText:y.ZB,VCardTitle:y.EB,VDialog:b.Z,VIcon:v.Z,VSpacer:_.Z});var Z={name:"Tour",components:{WelcomeDialog:R},computed:{...(0,l.rn)({isMobile:e=>e.ui.isMobile,showMap:e=>e.ui.showMap})},data(){return{callBacks:{onNextStep:this.nextStep,onFinish:this.finishTour},desktopSteps:[{target:'[data-tour-step="aoi"]',content:"Area of Interest configuration Section: Set up admin boundaries. Defaults to East Africa Region",params:{placement:"right",highlight:!0}},{target:'[data-tour-step="aoi-select"]',content:"Select Country or lower admin levels",params:{placement:"right"}},{target:'[data-tour-step="analysis"]',content:"Datasets Section: Toggle layer visibility, switch between dataset tabs, generate graphs, compare layers here",params:{placement:"right"}},{target:'[data-tour-step="remove-layer"]',content:"You can remove a layer on map from here (All available layers for this dataset are listed here)",params:{placement:"right"}},{target:'[data-tour-step="add-layer"]',content:"And add it again here",params:{placement:"top"}},{target:'[data-tour-step="date-params"]',content:"You can also set date parameters for respective layers from here. This will update both the map and the graphs below",params:{placement:"bottom"}},{target:'[data-tour-step="graphs"]',content:"Analysis Section: Depending on the layer selected, the date and area of interest, graphs will be displayed",params:{placement:"right"}},{target:'[data-tour-step="bar-range"]',content:"Adjust start and end year for graph below here",params:{placement:"right"}},{target:'[data-tour-step="map"]',content:"The map section shows all layers enabled from the analysis section. Here you can click, pan, zoom, identify or overlay data.",params:{placement:"left"}},{target:'[data-tour-step="opacity"]',content:"Adjust Layer opacity",params:{placement:"bottom",highlight:!1}},{target:'[data-tour-step="close-layer"]',content:"Remove Layer from map using this 'x' button",params:{placement:"bottom",highlight:!1}},{target:'[data-tour-step="split"]',content:"Compare Layers: Split map into two and compare top and bottom layers. Click on button again to revert to single map",params:{highlight:!1}},{target:'[data-tour-step="compare"]',content:"Compare Layers: Adjust layer parameters to make comparisons between two layers",params:{placement:"bottom"}}],mobileSteps:[{target:'[data-tour-step="aoi"]',content:"Area of Interest configuration Section: Set up admin boundaries. Defaults to East Africa Region",params:{placement:"bottom",highlight:!0}},{target:'[data-tour-step="aoi-select"]',content:"Select Country or lower admin levels",params:{placement:"bottom"}},{target:'[data-tour-step="analysis"]',content:"Datasets Section: Toggle layer visibility, switch between dataset tabs, generate graphs, compare layers here",params:{placement:"top",enableScrolling:!1}},{target:'[data-tour-step="remove-layer"]',content:"You can remove a layer on map from here (All available layers for this dataset are listed here)",params:{placement:"bottom"}},{target:'[data-tour-step="add-layer"]',content:"And add it again here",params:{placement:"bottom"}},{target:'[data-tour-step="date-params"]',content:"You can also set date parameters for respective layers from here. This will update both the map and the graphs below",params:{placement:"bottom"}},{target:'[data-tour-step="graphs"]',content:"Analysis Section: Depending on the layer selected, the date and area of interest, graphs will be displayed",params:{placement:"top",enableScrolling:!1}},{target:'[data-tour-step="bar-range"]',content:"Adjust start and end year for graph below here",params:{placement:"bottom"}},{target:'[data-tour-step="show-map"]',content:'To view the map interface click on the "show map" button',params:{placement:"bottom"}},{target:'[data-tour-step="map"]',content:"The map section shows all layers enabled from the analysis section. Here you can click, pan, zoom, identify or overlay data.",params:{placement:"bottom",highlight:!1}},{target:'[data-tour-step="opacity"]',content:"Adjust Layer opacity",params:{placement:"bottom",enableScrolling:!1,highlight:!1}},{target:'[data-tour-step="close-layer"]',content:"Remove Layer from map using this 'x' button",params:{placement:"bottom",highlight:!1}},{target:'[data-tour-step="show-analysis"]',content:"Close map and go back to analysis from here",params:{placement:"bottom"}},{target:'[data-tour-step="split"]',content:"Compare Layers: Split map into two and compare top and bottom layers. Click on button again to revert to single map",params:{placement:"bottom",highlight:!1}},{target:'[data-tour-step="compare"]',content:"Compare Layers: Adjust layer parameters to make comparisons between two layers",params:{placement:"right"}}]}},methods:{finishTour(){this.$store.dispatch("toggleDual"),this.$store.dispatch("toggleMapAnalysis")},nextStep(e){this.isMobile||(3===e&&document.querySelector('[data-switch="remove-layer"]').click(),4===e&&document.querySelector('[data-tour-step="add-layer"]').click(),10===e&&document.querySelector('[data-tour-step="split"]').click()),this.isMobile&&(8===e?document.querySelector('[data-tour-step="show-map"]').click():12===e?document.querySelector('[data-tour-step="show-analysis"]').click():13===e&&(document.querySelector('[data-tour-step="split"]').click(),document.querySelector('[data-tour-step="show-map"]').click()))}}},V=Z,I=(0,p.Z)(V,E,k,!1,null,"765a5310",null),O=I.exports,B={name:"App",components:{Navbar:T,Tour:O}},N=B,P=a(7524),z=a(7877),j=(0,p.Z)(N,s,i,!1,null,null,null),G=j.exports;m()(j,{VApp:P.Z,VMain:z.Z});var U=a(8345),Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isMobile?a("Mobile"):a("Desktop")},F=[],W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-row",{staticStyle:{height:"100%"},attrs:{"no-gutters":""}},[a("v-col",{staticClass:"overflow-auto analysisContainer",staticStyle:{height:"93vh"},attrs:{sm:"12",md:"6",lg:"7",xl:"6"}},[a("v-row",{staticClass:"grey lighten-4",staticStyle:{"min-height":"300px"},attrs:{"no-gutters":""}},[a("v-col",{staticClass:"lighten-5 px-6 py-6",attrs:{cols:"12"}},[a("AdminConfig")],1)],1),a("v-row",{staticClass:"grey darken-4",attrs:{"no-gutters":""}},[a("v-col",{staticClass:"px-4 py-3",attrs:{cols:"12"}},[a("Analysis")],1)],1)],1),a("v-col",{ref:"mapContainer",staticClass:"mapContainer grey darken-3",staticStyle:{"min-width":"100px","max-width":"100%",height:"auto"}},[a("Map")],1)],1)},q=[],H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("MapContainer")},J=[],Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.loading?a("div",{staticClass:"loader"},[e._m(0)]):a("div",{staticStyle:{height:"100%"}},[e.dual?a("div",{staticStyle:{height:"100%"}},[a("v-row",{staticStyle:{height:"50%"},attrs:{"no-gutters":""}},[a("v-col",[a("MglMap",{attrs:{accessToken:e.accessToken,mapStyle:e.mapStyle,center:e.center,zoom:e.zoom,attributionControl:!1,container:"map-top"},on:{"update:mapStyle":function(t){e.mapStyle=t},"update:map-style":function(t){e.mapStyle=t},load:e.onMapTopLoaded,moveend:e.mapTopSettings}},[a("MglScaleControl",{attrs:{position:"bottom-right"}}),a("MglNavigationControl",{attrs:{position:"top-left"}}),a("Legend",{attrs:{mapContainer:"mapTop"}}),a("div",{staticClass:"float py-2 px-11",staticStyle:{postion:"absolute"}},[e.isMobile?a("v-btn",{attrs:{fab:"","x-small":""},on:{click:e.toggleMapAnalysis}},[a("v-icon",{attrs:{small:""}},[e._v("mdi-close")])],1):e._e()],1)],1)],1)],1),a("v-divider",{staticClass:"white"}),a("v-row",{staticStyle:{height:"50%"},attrs:{"no-gutters":""}},[a("v-col",[a("MglMap",{attrs:{accessToken:e.accessToken,mapStyle:e.mapStyle,center:e.center,zoom:e.zoom,attributionControl:!1,container:"map-bottom"},on:{"update:mapStyle":function(t){e.mapStyle=t},"update:map-style":function(t){e.mapStyle=t},load:e.onMapBottomLoaded,moveend:e.mapBottomSettings}},[a("MglScaleControl",{attrs:{position:"bottom-right"}}),a("MglNavigationControl",{attrs:{position:"top-left"}}),a("Legend",{attrs:{mapContainer:"mapBottom"}})],1)],1)],1)],1):a("MglMap",{attrs:{accessToken:e.accessToken,mapStyle:e.mapStyle,center:e.center,zoom:e.zoom,attributionControl:!1,container:"map-single"},on:{"update:mapStyle":function(t){e.mapStyle=t},"update:map-style":function(t){e.mapStyle=t},load:e.onMapLoaded}},[a("MglScaleControl",{attrs:{position:"bottom-right"}}),a("MglNavigationControl",{attrs:{position:"top-left"}}),a("div",{staticClass:"float-start px-2",staticStyle:{postion:"absolute","padding-top":"110px"}},[e.isMobile?a("v-btn",{attrs:{fab:"","x-small":"","data-tour-step":"show-analysis"},on:{click:e.toggleMapAnalysis}},[a("v-icon",{attrs:{small:""}},[e._v("mdi-close")])],1):e._e()],1),a("Legend")],1)],1)},K=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"lds-ellipsis"},[a("div"),a("div"),a("div"),a("div")])}],X=a(7889),ee=a(6158),te=a.n(ee),ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"float-end ma-2",staticStyle:{postion:"absolute"},attrs:{"data-tour-step":"map"}},[a("v-card",{staticClass:"mx-auto rounded-sm",staticStyle:{"overflow-y":"auto"},attrs:{"max-width":"250px","min-width":"250px","max-height":"85vh",light:""}},[a("v-expansion-panels",{attrs:{multiple:""},model:{value:e.panel,callback:function(t){e.panel=t},expression:"panel"}},[a("v-expansion-panel",[a("v-expansion-panel-header",{staticClass:"subtitle-2 font-weight-medium grey--text text--darken-4"},[e._v(" LEGEND ")]),a("v-expansion-panel-content",{staticClass:"legendPanel"},[e.layers.filter((function(e){return e.visible&&!e.isBoundary})).length>0?a("v-list",{staticClass:"transparent"},[e.isDual?a("DualLegend",{staticStyle:{"max-height":"240px"},attrs:{layers:e.layers.filter((function(e){return e.visible})),mapContainer:e.mapContainer}}):a("SingleLegend")],1):a("v-list",{staticClass:"transparent"},[a("v-divider"),a("v-list-item",[a("v-list-item-title",{staticClass:"text-wrap caption text-center grey--text lighten-1"},[e._v("No layers added ")])],1)],1)],1)],1)],1)],1)],1)},oe=[],se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{"data-tour-step":"compare"}},[a("v-list-item",[a("v-select",{staticClass:"rounded-xl period-select",attrs:{items:e.layerFmt,"item-text":"name","item-value":"id",label:"Layer",outlined:"",dense:"","hide-details":"auto"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1),a("v-list-item",[a("v-list-item-content",[a("v-row",{attrs:{"no-gutters":""}},e._l(e.layers.find((function(t){return t.id===e.selected})).paramsSelectorConfig,(function(t){return a("v-col",{key:t.key},[a("v-select",{ref:"select"+e.mapContainer,refInFor:!0,staticClass:"rounded-xl period-select",attrs:{items:t.options,label:t.sentence.split(" ")[0],"item-text":"label","item-value":"value",outlined:"",dense:"","hide-details":"auto"},on:{input:function(a){e.updateParams(a,e.layers.find((function(t){return t.id===e.selected})),t.key)}}})],1)})),1),a("div",{staticClass:"pt-2"},e._l(e.layers.find((function(t){return t.id===e.selected})).legendConfig.items,(function(t){return a("v-list-item-title",{key:t.title,staticClass:"body-2 text-wrap pt-1",staticStyle:{"font-size":"12px !important"}},[a("v-avatar",{staticClass:"legend-avatar",attrs:{color:t.color,size:"10"}}),e._v(" "+e._s(t.name)+" ")],1)})),1)],1)],1)],1)},ie=[],re=a(6412);const ne=(e,t)=>{const a=t?.isBoundary;if(a)e.getSource(t.id.toString())||e.getLayer(t.id.toString())||e.addSource(t.id.toString(),t.layerConfig.source);else{let a=t.layerConfig.tiles[0];Object.keys(t.params).forEach((e=>{a=a.replace(`{${e}}`,t.params[e])})),t.visible?e.getSource(t.id.toString())||e.getLayer(t.id.toString())||e.addSource(t.id.toString(),{type:"raster",tiles:[a],minzoom:2,maxzoom:12,tileSize:256}):(e.getLayer(t.id.toString())&&e.removeLayer(t.id.toString()),e.getSource(t.id.toString())&&e.removeSource(t.id.toString()))}},le=(e,t,a)=>{if(t.visible&&a)if(!0===t.isBoundary)t.layerConfig.render.layers.map((t=>{e.getLayer(t.id.toString())||e.addLayer(t)}));else{const a=e.getStyle().layers;let o,s,i;for(const e of a)"level-0-line"===e.id&&(o=e.id),"level-1-line"===e.id&&(s=e.id),"level-2-line"===e.id&&(i=e.id);e.getLayer(t.id.toString())||(e.addLayer({id:t.id.toString(),type:"raster",source:t.id.toString(),layout:{visibility:"visible"}}),e.moveLayer(o),e.moveLayer(s),e.moveLayer(i))}},ce=(e,t)=>{if(e&&"IGAD"!==t.iso){e.getLayer("admin-level-1-layer")&&(e.removeLayer("admin-level-1-layer"),e.removeLayer("admin-level-1-layer-inner")),e.getSource("admin-level-1")&&e.removeSource("admin-level-1"),e.addSource("admin-level-1",{type:"geojson",data:t}),e.addLayer({id:"admin-level-1-layer",type:"line",source:"admin-level-1",paint:{"line-width":1.5,"line-color":"yellow","line-opacity":1,"line-gap-width":2}}),e.addLayer({id:"admin-level-1-layer-inner",type:"line",source:"admin-level-1",paint:{"line-width":2,"line-color":"#333","line-opacity":1}});let a=(0,re.Z)(t);e.fitBounds(a,{padding:30,easing:e=>e,linear:!0,animate:!0})}else if("IGAD"===t.iso){e.getLayer("admin-level-1-layer")&&(e.removeLayer("admin-level-1-layer"),e.removeLayer("admin-level-1-layer-inner")),e.getSource("admin-level-1")&&e.removeSource("admin-level-1"),e.addSource("admin-level-1",{type:"geojson",data:t});let a=(0,re.Z)(t);e.fitBounds(a,{padding:30,easing:e=>e,linear:!0,animate:!0})}},de=(e,t,a)=>{if(!0===t.isBoundary)t.layerConfig.render.layers.map((t=>{e.getLayer(t.id.toString())||e.addLayer(t)}));else{let o=a.layerConfig.tiles[0];Object.keys(a.params).forEach((e=>{o=o.replace(`{${e}}`,a.params[e])}));const s=e.getStyle().layers;let i,r,n;for(const e of s)"level-0-line"===e.id&&(i=e.id),"level-1-line"===e.id&&(r=e.id),"level-2-line"===e.id&&(n=e.id);e.getSource(t.id.toString())&&e.getLayer(t.id.toString())&&(e.removeLayer(t.id.toString()),e.removeSource(t.id.toString()),e.addSource(a.id.toString(),{type:"raster",tiles:[o],minzoom:2,maxzoom:12,tileSize:256}),e.addLayer({id:a.id.toString(),type:"raster",source:a.id.toString()}),e.moveLayer(i),e.moveLayer(r),e.moveLayer(n),e.getLayer("admin-level-1-layer")&&e.moveLayer("admin-level-1-layer"))}},pe=(e,t,a=null)=>{let o=t.layerConfig.tiles[0];a?Object.keys(a).forEach((e=>{o=o.replace(`{${e}}`,a[e])})):Object.keys(t.params).forEach((e=>{o=o.replace(`{${e}}`,t.params[e])}));const s=e.getStyle().layers;let i,r,n;for(const l of s)"level-0-line"===l.id&&(i=l.id),"level-1-line"===l.id&&(r=l.id),"level-2-line"===l.id&&(n=l.id);e.getSource(t.id.toString())&&e.getLayer(t.id.toString())&&(e.removeLayer(t.id.toString()),e.removeSource(t.id.toString()),e.addSource(t.id.toString(),{type:"raster",tiles:[o],minzoom:2,maxzoom:12,tileSize:256}),e.addLayer({id:t.id.toString(),type:"raster",source:t.id.toString()},i),e.moveLayer(r),e.moveLayer(n),e.getLayer("admin-level-1-layer")&&e.moveLayer("admin-level-1-layer"))},ue=(e,t)=>{e.on("click",(a=>{t&&(new(te().Popup)).setLngLat(a.lngLat).setHTML(`<p>Lng: ${a.lngLat.lng.toFixed(2)}, Lat: ${a.lngLat.lat.toFixed(2)}</p> <p> Value: ${t.properties.current_cdi}`).addTo(e)}))};var me={name:"DualLegend",props:["layers","mapContainer"],data(){return{selected:this.layers[this.layers.length-1].id,period:null}},computed:{...(0,l.rn)({boundaries:e=>e.boundary.boundaries}),paramSentence(){let e=this.layers.find((e=>e.id===this.selected)),t=e.paramsSentenceTemplate;return Object.keys(e.params).forEach((a=>{t=t.replace(`{${a}}`,e.params[a])})),t},layerFmt(){const e=this.layers.filter((e=>!e?.isBoundary));return e}},mounted(){let e=[],t=this.layers.find((e=>e.id===this.selected&&e.visible)),a=this.layers.filter((e=>e.isBoundary));e=a.concat([t]),e.map((e=>{ne(this.$store[this.mapContainer],e,this.boundaries),le(this.$store[this.mapContainer],e,this.boundaries)})),t.paramsSelectorConfig.map((e=>{let a=Object.keys(t.params).findIndex((t=>t===e.key));this.$refs["select"+this.mapContainer][a].setValue(t.params[e.key])}))},watch:{selected:{handler(e,t){let a=this.layers.find((e=>e.id===t)),o=this.layers.find((t=>t.id===e));de(this.$store[this.mapContainer],a,o,this.boundaries),o.paramsSelectorConfig.map((e=>{let t=Object.keys(o.params).findIndex((t=>t===e.key));console.log(this.$refs["select"+this.mapContainer]),this.$refs["select"+this.mapContainer][t]?.setValue(o.params[e.key])}))}}},methods:{updateParams(e,t,a){t.params[`${a}`]=e,console.log(t),pe(this.$store[this.mapContainer],t,t.params)}}},he=me,ge=a(6370),ye=a(2102),be=a(7620),fe=a(4051),ve=a(2877),_e=a(8994),Se=(0,p.Z)(he,se,ie,!1,null,null,null),Ce=Se.exports;m()(Se,{VAvatar:ge.Z,VCol:ye.Z,VListItem:be.Z,VListItemContent:fe.km,VListItemTitle:fe.V9,VRow:ve.Z,VSelect:_e.Z});var we=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("draggable",e._l(e.layers,(function(t){return a("div",{key:t.id,staticStyle:{"background-color":"white",cursor:"-webkit-grab"}},[t.visible&&!t.isBoundary?a("v-list-item",[a("v-list-item-content",{staticClass:"px-1"},[a("v-row",{staticClass:"pt-2",attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"8"}},[a("p",{staticClass:"body-2 font-weight-medium grey--text text--darken-3"},[e._v(" "+e._s(t.legendConfig.title)+" ")])]),a("v-col",[a("v-icon",{staticClass:"float-end py-1",attrs:{small:"","data-tour-step":"close-layer"},on:{click:function(a){return e.removeLayer(t)}}},[e._v("mdi-close")]),a("v-tooltip",{attrs:{top:"","x-small":"","nudge-bottom":"10",transition:"scroll-y-transition"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,s=t.attrs;return[a("v-icon",e._g(e._b({staticClass:"float-end py-1",attrs:{small:"","data-tour-step":"opacity"}},"v-icon",s,!1),o),[e._v("mdi-opacity")])]}}],null,!0)},[a("span",[e._v("Opacity (100%)")])])],1)],1),a("v-list-item-title",{staticClass:"pb-2"},[a("p",{staticClass:"grey--text text--darken-2",staticStyle:{"font-size":"12px"}},[e._v(" ( "+e._s(e.paramSentence(t))+" ) ")])]),e._l(t.legendConfig.items,(function(t){return a("v-list-item-title",{key:t.title,staticClass:"body-2 text-wrap",staticStyle:{"font-size":"12px !important"}},[a("v-avatar",{staticClass:"legend-avatar",attrs:{color:t.color,size:"10"}}),e._v(" "+e._s(t.name)+" ")],1)}))],2)],1):e._e(),t.visible?a("v-divider"):e._e()],1)})),0)],1)},xe=[],Te=a(9980),Ee=a.n(Te),ke={name:"SinglLegend",components:{draggable:Ee()},data:()=>({dialog:!1,yearRange:[2001,2022],startYear:2001,endYear:2022}),computed:{...(0,l.Se)({layers:"getActiveLayers"})},methods:{removeLayer(e){this.$store.dispatch("toggleLayerVisibility",{layerId:e.id})},paramSentence(e){let t=e.paramsSentenceTemplate;return Object.keys(e.params).forEach((a=>{t=t.replace(`{${a}}`,e.params[a])})),t}}},Ae=ke,$e=(0,p.Z)(Ae,we,xe,!1,null,"02bd5039",null),De=$e.exports;m()($e,{VAvatar:ge.Z,VCol:ye.Z,VDivider:f.Z,VIcon:v.Z,VListItem:be.Z,VListItemContent:fe.km,VListItemTitle:fe.V9,VRow:ve.Z,VTooltip:w.Z});var Le={name:"Legend",components:{SingleLegend:De,DualLegend:Ce},props:["mapContainer"],data:()=>({panel:[0]}),computed:{...(0,l.rn)({isDual:e=>e.mapContainer.isDual}),...(0,l.Se)({layers:"getActiveLayers"})}},Me=Le,Re=a(6845),Ze=a(2443),Ve=a(1192),Ie=a(5630),Oe=a(6816),Be=(0,p.Z)(Me,ae,oe,!1,null,null,null),Ne=Be.exports;m()(Be,{VCard:g.Z,VDivider:f.Z,VExpansionPanel:Re.Z,VExpansionPanelContent:Ze.Z,VExpansionPanelHeader:Ve.Z,VExpansionPanels:Ie.Z,VList:Oe.Z,VListItem:be.Z,VListItemTitle:fe.V9});var Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-card",{attrs:{light:""}},[a("v-card-text",[a("h3",{staticClass:"font-weight-regular pb-2"},[e._v("East Africa Boundaries")]),a("b",[e._v(e._s(e.params.locationName))]),e._v(", with a total area of "),a("b",[e._v(e._s(e.formatArea)+" ha")])]),a("div",{staticClass:"text-center"},[a("v-btn",{staticClass:"px-14",attrs:{rounded:"",dark:""},on:{click:function(t){return e.analyzeArea()}}},[e._v(" Analyze ")])],1)],1)],1)},ze=[],je=a(5324),Ge={name:"Popup",props:["params"],computed:{formatArea(e=!0){return(0,je.WU)(".3s")(this.params.area).replace("G",e?"B":" billion").replace("M",e?"M":" million").replace("K",e?"K":" thousand")}},methods:{analyzeArea(){const{level:e,gid_0:t,gid_1:a,gid_2:o}=this.params;2===e?(this.$store.commit("UPDATE_COUNTRY",t),this.$store.commit("UPDATE_REGION",a),this.$store.commit("UPDATE_SUBREGION",o),this.$store.dispatch("fetchBoundaries",{country:t,level:e+1,region:a,subregion:o})):1===e?(this.$store.commit("UPDATE_COUNTRY",t),this.$store.dispatch("fetchBoundaries",{country:t,level:e+1,region:a,subregion:null}),this.$store.commit("UPDATE_REGION",a)):0===e&&(this.$store.commit("UPDATE_COUNTRY",t),this.$store.dispatch("fetchBoundaries",{country:t,level:e+1,region:null,subregion:null}));const s=document.getElementsByClassName("mapboxgl-popup");s.length&&s[0].remove()}}},Ue=Ge,Ye=(0,p.Z)(Ue,Pe,ze,!1,null,null,null),Fe=Ye.exports;m()(Ye,{VBtn:h.Z,VCard:g.Z,VCardText:y.ZB});const We=o.Z.extend(Fe);var qe=!1,He={name:"MapContainer",components:{MglMap:X.Q3,MglNavigationControl:X.RV,MglScaleControl:X.RQ,Legend:Ne},data(){return{accessToken:"pk.eyJ1IjoiZ3JhY2VhbW9uZGkiLCJhIjoiY2s4dGphcGQwMDBhcjNmcnkzdGk3MnlrZCJ9.54r40Umo0l3dHseEbrQpUg",mapStyle:"mapbox://styles/graceamondi/cl1dtal7k00fb15muz5huqg5a",center:[36.6235,5.92859],zoom:3.7,loading:!0,rasterLayer:{type:"raster"}}},mounted(){this.$store.map=null,this.$store.mapTop=null,this.$store.mapBottom=null,this.subscribeToStore(),this.loading=!1},computed:{...(0,l.rn)({dual:e=>e.mapContainer.isDual,boundaries:e=>e.boundary.boundaries,source:e=>e.layer.layerConfig,infoUrl:e=>e.layer.infoUrl,featureInfo:e=>e.layer.featureInfo,isMobile:e=>e.ui.isMobile,showMap:e=>e.ui.showMap}),...(0,l.Se)({layers:"getActiveLayers"})},watch:{showMap:{handler(){this.dual?(this.$store.mapTop.resize(),this.$store.mapBottom.resize()):this.$store.map.resize()}}},methods:{toggleMapAnalysis(){this.$store.dispatch("toggleMapAnalysis")},mapTopSettings(e){this.$store.mapTop=e.map,qe||(qe=!0,this.$store.mapBottom.stop(),this.$store.mapBottom.jumpTo({center:this.$store.mapTop.getCenter(),zoom:this.$store.mapTop.getZoom()}),qe=!1)},mapBottomSettings(e){this.$store.mapBottom=e.map,qe||(qe=!0,this.$store.mapTop.stop(),this.$store.mapTop.jumpTo({center:this.$store.mapBottom.getCenter(),zoom:this.$store.mapBottom.getZoom()}),qe=!1)},onMapLoaded(e){this.$store.map=e.map,ce(this.$store.map,this.boundaries),0===this.layers.length?this.$store.dispatch("setLayers",{}):this.layers.map((e=>{ne(this.$store.map,e,this.boundaries),le(this.$store.map,e,this.boundaries)})),this.$store.map.on("click",(e=>{const t=[[e.point.x-5,e.point.y-5],[e.point.x+5,e.point.y+5]],a=this.$store.map.queryRenderedFeatures(t,{}),o=a[0].properties,{level:s,gid_0:i,gid_1:r,gid_2:n,name_1:l,name_0:c,area:d}=o;let p=o[`name_${s||"0"}`];i||(p=o[Object.keys(o).find((e=>e.includes("name")))]);let u=[p];2===s?u=[p,l,c]:1===s&&(u=[p,c]);const m=u.join(", ");console.log("Map popup",a),console.log("Level",s),console.log("Location Name",m);const h=(new(te().Popup)).setLngLat(e.lngLat).setHTML('<div id="popup-content"></div>').addTo(this.$store.map),g={locationName:m,area:d,level:s,gid_0:i,gid_1:r,gid_2:n},y=new We({store:this.$store,propsData:{params:g}});y.$mount("#popup-content"),h._update()}))},onMapTopLoaded(e){this.$store.mapTop=e.map,ce(this.$store.mapTop,this.boundaries)},onMapBottomLoaded(e){this.$store.mapBottom=e.map,ce(this.$store.mapBottom,this.boundaries)},subscribeToStore(){this.dataUnsubscribe=this.$store.subscribe((e=>{switch(e.type){case"SET_LAYERS":this.dual||this.layers.map((e=>{ne(this.$store.map,e,this.boundaries),le(this.$store.map,e,this.boundaries)}));break;case"SET_FEATURE_INFO":ue(this.$store.map,this.featureInfo);break;case"TOGGLE_LAYER_VISIBILITY":this.toggleVisibility();break;case"SET_BOUNDARY":this.dual?(ce(this.$store.mapTop,this.boundaries),ce(this.$store.mapBottom,this.boundaries)):ce(this.$store.map,this.boundaries);break;case"RESET_BOUNDARY":this.dual?(ce(this.$store.mapTop,this.boundaries),ce(this.$store.mapBottom,this.boundaries)):ce(this.$store.map,this.boundaries);break;case"TOGGLE_DUAL":this.zoom=this.dual?2.6:3.7;break}}))},toggleVisibility(){this.dual||this.layers.map((e=>{ne(this.$store.map,e,this.boundaries),le(this.$store.map,e,this.boundaries)}))}}},Je=He,Qe=(0,p.Z)(Je,Q,K,!1,null,null,null),Ke=Qe.exports;m()(Qe,{VBtn:h.Z,VCol:ye.Z,VDivider:f.Z,VIcon:v.Z,VRow:ve.Z});var Xe={name:"Map",components:{MapContainer:Ke}},et=Xe,tt=(0,p.Z)(et,H,J,!1,null,null,null),at=tt.exports,ot=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{"data-tour-step":"aoi"}},[a("v-container",[a("v-row",{staticClass:"admin justify-center"},[a("v-col",{attrs:{sm:"12",md:"12",lg:"7",xl:"7"}},[a("div",{staticClass:"pb-6"},[e.isMobile?a("v-btn",{staticClass:"float-end",attrs:{rounded:"","x-small":"",dark:"","data-tour-step":"show-map"},on:{click:e.toggleMapAnalysis}},[e._v(" Show map ")]):e._e()],1),!e.isMobile&&e.isMobile?a("div",{staticClass:"pb-8"},[a("Report")],1):e._e(),e.selectedCountry?e._e():a("p",{staticStyle:{"font-size":"35px"}},[e._v("East Africa")]),a("v-select",{attrs:{"data-tour-step":"aoi-select",items:e.countries,"item-text":"name",label:"Select country","single-line":"","item-value":"id",clearable:""},on:{input:function(t){return e.updateCountry(1)}},model:{value:e.selectedCountry,callback:function(t){e.selectedCountry=t},expression:"selectedCountry"}}),e.selectedCountry?a("v-select",{attrs:{loading:e.regions.length<=0,items:e.regions,"item-text":"name","item-value":"id",label:"Select a region","single-line":"",clearable:""},on:{input:function(t){return e.updateCountry(2)}},model:{value:e.selectedRegion,callback:function(t){e.selectedRegion=t},expression:"selectedRegion"}}):e._e(),e.selectedRegion?a("v-select",{attrs:{loading:e.subRegions.length<=0,items:e.subRegions,"item-text":"name","item-value":"id",label:"Select a region","single-line":"",clearable:""},on:{input:function(t){return e.updateCountry(3)}},model:{value:e.selectedSubRegion,callback:function(t){e.selectedSubRegion=t},expression:"selectedSubRegion"}}):e._e()],1)],1)],1)],1)},st=[],it=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"float-end",attrs:{rounded:"",small:"",dark:""}},"v-btn",s,!1),o),[e._v(" Generate report ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("nav",[a("v-toolbar",{staticStyle:{color:"#f5c10d"},attrs:{flat:"",dark:"",fixed:""}},[a("v-btn",{attrs:{icon:"",dark:""},on:{click:function(t){e.dialog=!1}}},[a("v-icon",[e._v("mdi-close")])],1),a("v-toolbar-title",{staticStyle:{"font-size":"16px","font-weight":"bold"}},[e._v("GENERATE REPORT "),e.place.country?a("span",[e._v(" ("+e._s(e.place.country)+e._s(e.place.region)+e._s(e.place.subregion)+") ")]):a("span",[e._v("(East Africa)")])]),a("v-spacer"),a("v-toolbar-items",[a("v-btn",{attrs:{dark:"",text:""},on:{click:function(t){return e.generatePDF()}}},[e._v(" Download ")])],1)],1)],1),a("v-container",e._l(e.layers,(function(t){return a("div",{key:t.id,staticStyle:{position:"inherit !important",all:"inherit !important"},attrs:{slot:"pdf-content"},slot:"pdf-content"},["ppt_gpcc"===t.slug||"fapar_absorbed"===t.slug||t.isBoundary?e._e():a("div",[a("v-card",{staticStyle:{"border-bottom":"1px #9ea2a4 solid !important",display:"flex !important","align-items":"center !important","box-shadow":"0px 3px 1px -2px rgb(0 0 0 / 20%),"},attrs:{dark:"","min-height":"794px",elevation:"24",raised:""}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"3"}},[a("v-card",{staticClass:"rounded-r-xl",attrs:{light:"","min-height":"734px"}},[a("v-card-title",{staticClass:"text-uppercase grey--text text--darken-4",staticStyle:{"font-size":"16px","word-break":"break-word"}},[e._v(e._s(t.name))]),a("v-card-subtitle",{staticClass:"text-uppercase grey--text text--darken-3"},[e.place.country?a("span",[e._v(" "+e._s(e.place.country)+e._s(e.place.region)+e._s(e.place.subregion)+" ")]):a("span",[e._v(" East Africa")])]),a("v-card-text",{staticClass:"grey--text text--darken-4"},[e._v(" "+e._s(t.description)+" ")]),a("v-divider"),a("v-card-text",[a("v-textarea",{staticStyle:{"line-height":"0.375rem !important","letter-spacing":"0.0071428571em !important","font-size":"0.875rem !important"},attrs:{name:"input-7-1",label:"Add Description",value:"Analysis shows a high prevalence of rainfall deficit covering more than half of the region. Traces of Soil Moisture Deficit and Vegetation Stress appear mostly in parts of Kenya, Ethiopia and Tanzania.",hint:"Maximum words, 1000","auto-grow":""}})],1)],1)],1),a("v-col",{staticClass:"float-start",attrs:{cols:"4"}},[a("ParameterMap",{attrs:{layer:t}})],1),a("v-col",{attrs:{cols:"5"}},[t.analysisConfig.pieChart?a("Pie",{staticStyle:{width:"100%"},attrs:{layer:t}}):e._e()],1)],1)],1)],1)])})),0)],1)],1)},rt=[],nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-chart",{ref:"barChart",staticClass:"chart px-4 my-5 text-wrap",staticStyle:{height:"480px"},attrs:{option:e.option,theme:e.theme,autoresize:"",loading:e.loading,"loading-options":e.loadingOptions}})],1)},lt=[],ct=a(4297),dt={props:["layer"],data:()=>({option:{title:{text:"Population exposed in affected areas",left:"left"},textStyle:{},legend:{data:[],bottom:0},tooltip:{},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},saveAsImage:{show:!0}},top:0},series:{type:"pie",radius:["20%","60%"],center:["50%","55%"],itemStyle:{borderRadius:8,margin:100},data:[]}},loadingOptions:{maskColor:"transparent",spinnerRadius:20,text:"",lineWidth:3,color:"#f6ca0a"}}),components:{VChart:ct.ZP},computed:{...(0,l.rn)({theme:e=>e.chart.theme,pieData:e=>e.chart.pieData,countries:e=>e.boundary.countryNames,subregions:e=>e.boundary.subRegionNames,regions:e=>e.boundary.regionNames,loading:e=>e.chart.pieLoading}),...(0,l.Se)({places:"selectedPlaces"}),place:function(){let e={country:"",region:"",subregion:""};return this.places.subregion&&(e.subregion=`${this.subregions.find((e=>e.id===this.places.subregion)).name}, `),this.places.region&&(e.region=`${this.regions.find((e=>e.id===this.places.region)).name}, `),this.places.country&&(e.country=`${this.countries.find((e=>e.id===this.places.country)).name}`),e}},mounted(){this.subscribeToStore()},methods:{subscribeToStore(){this.dataUnsubscribe=this.$store.subscribe((e=>{switch(e.type){case"SET_PIE_DATA":this.fetchData();break}}))},fetchData(){let e=[];this.pieData.filter((e=>"partial_recovery"!==e.category&&"full_recovery"!==e.category&&"no_data"!==e.category)).map((t=>{e.push({value:Math.round(t.population),name:t.category,itemStyle:{color:this.layer.analysisConfig.color[this.layer.analysisConfig.dimensions.findIndex((e=>e===t.category))-1]}})}));const t={"01":"1st",11:"2nd",21:"3rd"},a={"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September",10:"October",11:"November",12:"December"};this.place.country||this.place.region||this.place.subregion?this.option.title.subtext=`On the ${t[this.layer.params.selectedTenDays]} TenDay Period of ${a[this.layer.params.selectedMonth]}, ${this.layer.params.selectedYear}\n${this.place.subregion}${this.place.region}${this.place.country}`:this.option.title.subtext=`On the ${t[this.layer.params.selectedTenDays]} TenDay Period of ${a[this.layer.params.selectedMonth]}, ${this.layer.params.selectedYear}\nIn East Africa`,this.option.series.data=e,this.option.legend.data=[],this.option.series.data.map((e=>{this.option.legend.data.push(e.name)}))}}},pt=dt,ut=(0,p.Z)(pt,nt,lt,!1,null,"40b8ec96",null),mt=ut.exports,ht=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.base64MapImg&&!e.loading?a("img",{staticClass:"float-end",staticStyle:{"max-width":"100%","max-height":"100%"},attrs:{src:e.base64MapImg,alt:"",height:"auto"}}):a("div",{staticClass:"loader"},[e._m(0)])},gt=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"lds-ellipsis"},[a("div"),a("div"),a("div"),a("div")])}],yt=a(9669),bt={name:"ParameterMap",props:["layer"],data(){return{loading:!0,base64MapImg:null}},computed:{...(0,l.rn)({boundaries:e=>e.boundary.boundaries})},mounted(){this.fetchMap(),this.subscribeToStore()},watch:{layer:{handler(){this.loading=!0,this.fetchMap()},deep:!0}},methods:{subscribeToStore(){this.dataUnsubscribe=this.$store.subscribe((e=>{switch(e.type){case"SET_BOUNDARY":this.loading=!0,this.fetchMap();break;case"RESET_BOUNDARY":this.loading=!0,this.fetchMap();break}}))},fetchMap(){let e=this.layer.layerConfig.tiles[0];Object.keys(this.layer.params).forEach((t=>{e=e.replace(`{${t}}`,this.layer.params[t])}));const t=24e4,a={width:500,height:735,padding:25,ratio:1,bounds:(0,re.Z)(this.boundaries),style:{version:8,sprite:"https://eahazardswatch.icpac.net/tileserver-gl/styles/eahw/sprite",sources:{basemap:{type:"raster",tiles:["https://api.mapbox.com/styles/v1/graceamondi/cl1dtal7k00fb15muz5huqg5a/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoiZ3JhY2VhbW9uZGkiLCJhIjoiY2s4dGphcGQwMDBhcjNmcnkzdGk3MnlrZCJ9.54r40Umo0l3dHseEbrQpUg"],tileSize:256},boundaries:{type:"vector",tiles:["https://eahazardswatch.icpac.net/pg/tileserv/pgadapter.ea_gadm36_political_boundaries/{z}/{x}/{y}.pbf"]},admin_boundary:{type:"geojson",data:this.boundaries},parameter_layer:{type:"raster",tiles:[e],minzoom:2,maxzoom:12,tileSize:256},labels:{type:"raster",tiles:["https://eahazardswatch.icpac.net/tileserver-gl/styles/labels_dark/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"basemap",type:"raster",source:"basemap"},{id:"parameter_layer",type:"raster",source:"parameter_layer"},{id:"boundaries_lvl_1",type:"line",source:"boundaries","source-layer":"pgadapter.ea_gadm36_political_boundaries",filter:["==","level",0],layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#8a8a8a","line-width":1,"line-opacity":.5}},{id:"boundaries_lvl_2",type:"line",source:"boundaries","source-layer":"pgadapter.ea_gadm36_political_boundaries",filter:["==","level",1],layout:{"line-join":"round","line-cap":"round"},paint:"IGAD"===this.boundaries.iso?{"line-color":"transparent"}:{"line-color":"#8a8a8a","line-width":1,"line-opacity":.3}},{id:"admin-level-1-layer",type:"line",source:"admin_boundary",paint:"IGAD"===this.boundaries.iso?{"line-color":"transparent"}:{"line-width":1.5,"line-color":"yellow","line-opacity":1,"line-gap-width":2}},{id:"admin-level-1-layer-inner",type:"line",source:"admin_boundary",paint:"IGAD"===this.boundaries.iso?{"line-color":"transparent"}:{"line-width":2,"line-color":"#333","line-opacity":1}}]}};(0,yt.create)({timeout:t}).post("https://eahazardswatch.icpac.net/mbgl-renderer/render/",{...a},{responseType:"blob"}).then((e=>new Promise((t=>{let a=new FileReader;a.readAsDataURL(e.data),a.onload=function(){t(this.result)}})))).then((e=>{this.base64MapImg=e,this.loading=!1})).catch((e=>{this.base64MapImg=null,this.loading=!0,console.log("Error encountered when creating static Map",e)}))}}},ft=bt,vt=(0,p.Z)(ft,ht,gt,!1,null,null,null),_t=vt.exports,St={name:"Report",components:{Pie:mt,ParameterMap:_t},computed:{...(0,l.rn)({countries:e=>e.boundary.countryNames,subregions:e=>e.boundary.subRegionNames,regions:e=>e.boundary.regionNames}),...(0,l.Se)({layers:"getActiveLayers",places:"selectedPlaces"}),place:function(){let e={country:"",region:"",subregion:""};return this.places.country&&(e.country=this.countries.find((e=>e.id===this.places.country)).name),this.places.region&&(e.region=`, ${this.regions.find((e=>e.id===this.places.region)).name}`),this.places.subregion&&(e.subregion=`, ${this.subregions.find((e=>e.id===this.places.subregion)).name}`),e}},data(){return{dialog:!1,htmlToPdfOptions:{margin:0,filename:"hehehe.pdf",image:{type:"jpeg",quality:2},enableLinks:!1,html2canvas:{scale:1,useCORS:!0},jsPDF:{format:"a4",orientation:"landscape"}}}},methods:{onProgress(e){console.log(`Processed: ${e} / 100`)},hasGenerated(){alert("PDF generated successfully!")},generatePDF(){this.$refs.html2Pdf.generatePdf()}}},Ct=St,wt=a(9846),xt=a(4350),Tt=(0,p.Z)(Ct,it,rt,!1,null,null,null),Et=Tt.exports;m()(Tt,{VBtn:h.Z,VCard:g.Z,VCardSubtitle:y.Qq,VCardText:y.ZB,VCardTitle:y.EB,VCol:ye.Z,VContainer:wt.Z,VDialog:b.Z,VDivider:f.Z,VIcon:v.Z,VRow:ve.Z,VSpacer:_.Z,VTextarea:xt.Z,VToolbar:S.Z,VToolbarItems:C.lj,VToolbarTitle:C.qW});var kt={components:{Report:Et},computed:{...(0,l.rn)({countries:e=>e.boundary.countryNames,regions:e=>e.boundary.regionNames,subRegions:e=>e.boundary.subRegionNames,boundary:e=>e.boundary.boundaries,isMobile:e=>e.ui.isMobile}),selectedCountry:{get(){return this.$store.state.boundary.selectedCountry},set(e){return this.$store.commit("UPDATE_COUNTRY",e)}},selectedRegion:{get(){return this.$store.state.boundary.selectedRegion},set(e){return this.$store.commit("UPDATE_REGION",e)}},selectedSubRegion:{get(){return this.$store.state.boundary.selectedSubRegion},set(e){return this.$store.commit("UPDATE_SUBREGION",e)}}},methods:{toggleMapAnalysis(){this.$store.dispatch("toggleMapAnalysis"),this.$store.map.resize()},updateCountry(e){1===e&&(this.selectedRegion=null,this.selectedSubRegion=null),2===e&&(this.selectedSubRegion=null),this.selectedCountry||this.selectedRegion||this.selectedSubRegion?!this.selectedCountry||this.selectedRegion||this.selectedSubRegion?this.selectedCountry&&this.selectedRegion&&!this.selectedSubRegion&&(e=2):e=1:e=0,0!==e||this.selectedCountry?this.$store.dispatch("fetchBoundaries",{country:this.selectedCountry,level:e,region:this.selectedRegion,subregion:this.selectedSubRegion}):this.$store.dispatch("resetBoundary")}}},At=kt,$t=(0,p.Z)(At,ot,st,!1,null,null,null),Dt=$t.exports;m()($t,{VBtn:h.Z,VCol:ye.Z,VContainer:wt.Z,VRow:ve.Z,VSelect:_e.Z});var Lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("DatasetTabs",{staticStyle:{"align-self":"center"},attrs:{"data-tour-step":"analysis"}})],1)},Mt=[],Rt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.loading?a("div",{staticClass:"loader"},[e._m(0)]):a("div",[e.datasets.length?a("v-tabs",{attrs:{"icons-and-text":"","show-arrows":"","background-color":"grey darken-4",dark:"",centered:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider"),e._l(e.datasets,(function(t){return a("div",{key:t.id},[a("v-tab",{attrs:{href:"#"+t.id}},[a("p",[e._v(e._s(t.name))]),a("v-icon",{attrs:{small:""}},[e._v("mdi-"+e._s(t.icon))])],1)],1)}))],2):e._e(),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},e._l(e.datasets,(function(e){return a("v-tab-item",{key:e.id,attrs:{value:e.id}},[a("AnalysisContainer",{attrs:{datasetName:e.name}})],1)})),1)],1)},Zt=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"lds-ellipsis"},[a("div"),a("div"),a("div"),a("div")])}],Vt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-card",{staticClass:"overflow-visible",attrs:{flat:""}},[a("LayerTabs",{attrs:{datasetName:e.datasetName}})],1)],1)},It=[],Ot=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.filterDatasets?a("v-row",{staticClass:"grey darken-4 justify-center"},[a("v-col",{attrs:{sm:"12",md:"12",lg:"11",xl:"11"}},[a("v-card",{staticClass:"overflow-visible my-3 pa-6",attrs:{flat:"",dark:"",outlined:""}},[a("p",{staticClass:"grey--text text--lighten-2"},[e._v(" Explore interactive charts and maps that summarize prevalence and trend in drought intensity and frequency "),e.place.country?a("span",{staticClass:"white--text text--darken-1 font-weight-bold"},[e._v(" in "+e._s(e.place.country)+e._s(e.place.region)+e._s(e.place.subregion))]):e._e(),e._v(". ")]),a("span",{domProps:{innerHTML:e._s(e.filterDatasets.content)}}),a("div",{attrs:{"data-tour-step":"remove-layer"}},e._l(e.filterDatasets.layers,(function(t){return a("v-switch",{key:t.key,staticClass:"py-0",attrs:{color:"#f5c10d","input-value":t.visible,label:t.name,"data-switch":"remove-layer"},on:{click:function(a){return e.toggleLayerVisibility(t.id)}}})})),1)]),e._l(e.filterDatasets.layers,(function(t){return a("v-card",{key:t.id,staticClass:"rounded-lg grey--text text--lighten-2 my-3",attrs:{dark:"",outlined:""}},[a("v-card-title",[a("v-row",[a("v-col",[a("p",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(t.name))])]),a("v-col",[t.visible?a("v-btn",{staticClass:"float-end",attrs:{rounded:"",small:"",light:"","data-tour-step":"add-layer"},on:{click:function(a){return e.toggleLayerVisibility(t.id)}}},[e._v(" Remove Layer ")]):a("v-btn",{staticClass:"float-end",attrs:{"data-tour-step":"add-layer",rounded:"",small:""},on:{click:function(a){return e.toggleLayerVisibility(t.id)}}},[e._v(" Show on map ")])],1)],1)],1),a("LayerControls",{staticClass:"pa-3",attrs:{layer:t}}),a("div",{attrs:{"data-tour-step":"graphs"}},[a("v-card",{staticClass:"ma-3",attrs:{outlined:""}},[t.analysisConfig.pieChart?a("Pie",{attrs:{layer:t}}):e._e(),a("v-divider"),t.analysisConfig.barChart?a("v-row",{staticClass:"pt-4 px-4",attrs:{"data-tour-step":"bar-range"}},[a("v-col",{attrs:{sm:"5",md:"5",lg:"5",xl:"5",xs:"6"}},[a("v-select",{ref:"startYear",refInFor:!0,staticClass:"rounded-xl period-select",attrs:{items:e.yearLs(t),"item-text":"label","item-value":"value",label:"Start Year",outlined:"",dense:"",value:t.analysisConfig.barRange[0],rules:[function(e){return e&&e<=t.analysisConfig.barRange[1]||"Must be less than end year"}],"hide-details":"auto"},on:{input:function(a){return e.setBarRange(t)}}})],1),a("v-spacer"),a("v-col",{attrs:{sm:"5",md:"5",lg:"5",xl:"5",xs:"6"}},[a("v-select",{ref:"endYear",refInFor:!0,staticClass:"rounded-xl period-select",attrs:{items:e.yearLs(t),"item-text":"label","item-value":"value",label:"End Year",outlined:"",dense:"",value:t.analysisConfig.barRange[1],rules:[function(e){return e&&e>=t.analysisConfig.barRange[0]||"Must be greater than start year"}],"hide-details":"auto"},on:{input:function(a){return e.setBarRange(t)}}})],1)],1):e._e(),t.analysisConfig.barChart?a("Bar",{attrs:{layer:t}}):e._e()],1)],1)],1)}))],2)],1):e._e()},Bt=[],Nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("PeriodSelector",{attrs:{layer:e.layer}})],1)},Pt=[],zt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-item-group",{attrs:{dark:""}},[a("v-row",{attrs:{"no-gutters":""}},[e._l(e.layer.paramsSelectorConfig,(function(t){return a("v-col",{key:t.key,staticClass:"px-1",attrs:{sm:"2",xs:"12",md:"2",lg:"2",xl:"2","data-tour-step":"date-params"}},[a("v-item",[a("v-select",{ref:"param",refInFor:!0,staticClass:"rounded-xl period-select",attrs:{items:t.options,label:t.sentence.split(" ")[0],"item-text":"label","item-value":"value",outlined:"",value:e.layer.params[t.key],dense:"",disabled:e.isDual},on:{input:function(a){return e.updateParams(a,t.key)}}})],1)],1)})),a("v-spacer"),a("Metadata",{attrs:{layer:e.layer}})],2)],1)],1)},jt=[],Gt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,s=t.attrs;return[e.isDual?a("v-btn",e._g(e._b({staticClass:"rounded-circle",attrs:{color:"blue-grey darken-2"},on:{click:e.toggleDual}},"v-btn",s,!1),o),[a("v-icon",{attrs:{small:""}},[e._v("mdi-compare-remove")])],1):a("v-btn",e._g(e._b({staticClass:"rounded-circle",attrs:{color:"blue-grey darken-2","data-tour-step":"split"},on:{click:e.toggleDual}},"v-btn",s,!1),o),[a("v-icon",{attrs:{small:""}},[e._v("mdi-compare")])],1)]}}])},[a("span",[e._v("Compare layers")])]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"rounded-circle hidden-xl-only hidden-lg-only hidden-md-only",attrs:{color:"blue-grey darken-2"}},"v-btn",s,!1),o),[a("v-icon",{attrs:{small:""}},[e._v("mdi-map")])],1)]}}])},[a("span",[e._v("Show layer on map")])]),a("MetadataModal",{attrs:{layer:e.layer}})],1)},Ut=[],Yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var o=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"rounded-circle",attrs:{color:"blue-grey darken-2"}},"v-btn",s,!1),o),[a("v-icon",{attrs:{small:""}},[e._v("mdi-information")])],1)]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"text-h5 py-9"},[e._v(" "+e._s(e.layer.name)+" ")]),a("v-divider"),a("v-card-text",{staticClass:"py-4"},[e._v(" "+e._s(e.layer.description)+" ")]),a("v-divider")],1)],1)},Ft=[],Wt={name:"MetadataModal",data(){return{dialog:!1}},props:["layer"]},qt=Wt,Ht=(0,p.Z)(qt,Yt,Ft,!1,null,null,null),Jt=Ht.exports;m()(Ht,{VBtn:h.Z,VCard:g.Z,VCardText:y.ZB,VCardTitle:y.EB,VDialog:b.Z,VDivider:f.Z,VIcon:v.Z});var Qt={name:"Metadata",components:{MetadataModal:Jt},props:["layer"],computed:{...(0,l.rn)({isDual:e=>e.mapContainer.isDual,boundaries:e=>e.boundary.boundaries,country:e=>e.boundary.boundaries})},methods:{toggleDual(){this.$store.dispatch("toggleDual")}}},Kt=Qt,Xt=(0,p.Z)(Kt,Gt,Ut,!1,null,null,null),ea=Xt.exports;m()(Xt,{VBtn:h.Z,VIcon:v.Z,VTooltip:w.Z});var ta={name:"PeriodSelector",components:{Metadata:ea},props:["layer"],computed:{...(0,l.rn)({isDual:e=>e.mapContainer.isDual,boundary:e=>e.boundary.boundaries})},watch:{layer:{handler(e){this.isDual||pe(this.$store.map,e)}}},methods:{updateParams(e,t){let a=this.layer.params;a[`${t}`]=e,this.$store.dispatch("setParams",{id:this.layer.id,params:a}),this.$store.dispatch("fetchPieData",{slug:this.layer.slug,geojson:this.boundary,date:a,enable:this.layer.analysisConfig.pieChart}),pe(this.$store.map,this.layer,a)}}},aa=ta,oa=a(8215),sa=a(4622),ia=(0,p.Z)(aa,zt,jt,!1,null,null,null),ra=ia.exports;m()(ia,{VCol:ye.Z,VItem:oa.Z,VItemGroup:sa.Z,VRow:ve.Z,VSelect:_e.Z,VSpacer:_.Z});var na={name:"LayerControls",components:{PeriodSelector:ra},props:["layer"],computed:{...(0,l.rn)({boundary:e=>e.boundary.boundaries})}},la=na,ca=(0,p.Z)(la,Nt,Pt,!1,null,"94fe4e0e",null),da=ca.exports,pa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-chart",{staticClass:"chart px-4 my-5",staticStyle:{height:"350px"},attrs:{theme:e.theme,autoresize:"",option:e.option,loading:e.loading,"loading-options":e.loadingOptions}})],1)},ua=[],ma={props:["layer"],data:()=>({option:{title:{text:"Ten Day Drought prevalence",left:"left",top:0},toolbox:{show:!0,feature:{saveAsImage:{show:!0},dataZoom:{show:!0,filterMode:"filter"},magicType:{show:!0,type:["line","bar","stack"]},top:0}},tooltip:{trigger:"axis"},dataset:{dimensions:[],source:[]},xAxis:{type:"category"},yAxis:{max:"dataMax",show:!0,nameLocation:"middle",nameGap:20,nameRotate:90,name:"% of whole region"},legend:{data:[],bottom:"bottom"},series:[],color:[]},loadingOptions:{maskColor:"transparent",spinnerRadius:20,text:"",lineWidth:3,color:"#f6ca0a"}}),components:{VChart:ct.ZP},computed:{...(0,l.rn)({theme:e=>e.chart.theme,barData:e=>e.chart.barData,countries:e=>e.boundary.countryNames,subregions:e=>e.boundary.subRegionNames,regions:e=>e.boundary.regionNames,loading:e=>e.chart.barLoading}),...(0,l.Se)({places:"selectedPlaces"}),place:function(){let e={country:"",region:"",subregion:""};return this.places.subregion&&(e.subregion=`${this.subregions.find((e=>e.id===this.places.subregion)).name}, `),this.places.region&&(e.region=`${this.regions.find((e=>e.id===this.places.region)).name}, `),this.places.country&&(e.country=`${this.countries.find((e=>e.id===this.places.country)).name}`),e}},mounted(){this.subscribeToStore()},methods:{subscribeToStore(){this.dataUnsubscribe=this.$store.subscribe((e=>{switch(e.type){case"SET_BAR_DATA":this.fetchData();break}}))},fetchData(){let e=[];this.layer.analysisConfig.data.forEach((t=>{e.push({type:"bar",stack:"one",name:t})})),this.option.dataset.source=this.barData,this.option.dataset.dimensions=this.layer.analysisConfig.dimensions,this.place.country||this.place.region||this.place.subregion?this.option.title.subtext=`${this.place.subregion}${this.place.region}${this.place.country}`:this.option.title.subtext="East Africa",this.option.color=this.layer.analysisConfig.color,this.option.legend.data=this.layer.analysisConfig.data,this.option.series=e}}},ha=ma,ga=(0,p.Z)(ha,pa,ua,!1,null,"26437aa2",null),ya=ga.exports,ba=a(8023),fa=a(1416),va=a(1758),_a=a(8690),Sa=a(2739),Ca=a(6395);(0,ba.D)([fa.N,va.N,_a.N,Sa.N,Ca.N]);var wa={name:"LayerTabs",components:{LayerControls:da,Bar:ya,Pie:mt},props:["datasetName"],data(){return{tab:null,startYear:null,endYear:null}},computed:{...(0,l.rn)({datasets:e=>e.dataset.datasets,countries:e=>e.boundary.countryNames,subregions:e=>e.boundary.subRegionNames,regions:e=>e.boundary.regionNames,dual:e=>e.mapContainer.isDual,boundary:e=>e.boundary.boundaries}),...(0,l.Se)({places:"selectedPlaces"}),filterDatasets:function(){return this.datasets.find((e=>e.name===this.datasetName&&!e.isBoundary))},place:function(){let e={country:"",region:"",subregion:""};return this.places.country&&(e.country=this.countries.find((e=>e.id===this.places.country)).name),this.places.region&&(e.region=`, ${this.regions.find((e=>e.id===this.places.region)).name}`),this.places.subregion&&(e.subregion=`, ${this.subregions.find((e=>e.id===this.places.subregion)).name}`),e}},methods:{yearLs(e){let t=e.paramsSelectorConfig.find((e=>"selectedYear"===e.key));return t.options},disabledYears(e){let t=[],a=e.paramsSelectorConfig.find((e=>"selectedYear"===e.key)).options;return a&&(a=a.filter((t=>t.value>e.analysisConfig.barRange[1])),a.map((e=>{t.push(e.label)}))),t},toggleLayerVisibility(e){this.$store.dispatch("toggleLayerVisibility",{layerId:e})},setBarRange(e){this.$store.dispatch("setBarRange",{id:e.id,barRange:[this.$refs.startYear[0].lazyValue,this.$refs.endYear[0].lazyValue]}),this.$store.dispatch("fetchBarData",{slug:e.slug,geojson:this.boundary,enable:e.analysisConfig.barChart,barRange:e.analysisConfig.barRange})}}},xa=wa,Ta=a(6251),Ea=(0,p.Z)(xa,Ot,Bt,!1,null,null,null),ka=Ea.exports;m()(Ea,{VBtn:h.Z,VCard:g.Z,VCardTitle:y.EB,VCol:ye.Z,VDivider:f.Z,VRow:ve.Z,VSelect:_e.Z,VSpacer:_.Z,VSwitch:Ta.Z});var Aa={name:"AnalysisContainer",components:{LayerTabs:ka},props:["datasetName"]},$a=Aa,Da=(0,p.Z)($a,Vt,It,!1,null,"6f9b366c",null),La=Da.exports;m()(Da,{VCard:g.Z});var Ma={name:"DatasetTabs",components:{AnalysisContainer:La},data(){return{tab:null}},computed:{...(0,l.rn)({datasets:e=>e.dataset.datasets,loading:e=>e.dataset.loading,boundary:e=>e.boundary.boundaries})},watch:{tab:{handler(e){let t=this.datasets.find((t=>t.id===e));t.layers.map((e=>{e.isBoundary||(this.$store.dispatch("fetchPieData",{slug:e.slug,geojson:this.boundary,date:e.params,enable:e.analysisConfig.pieChart}),this.$store.dispatch("fetchBarData",{slug:e.slug,geojson:this.boundary,enable:e.analysisConfig.barChart,barRange:e.analysisConfig.barRange}))}))}},boundary:{handler(e){let t=this.datasets.find((e=>e.id===this.tab));t.layers.map((t=>{t.isBoundary||(this.$store.dispatch("fetchPieData",{slug:t.slug,geojson:e,date:t.params,enable:t.analysisConfig.pieChart}),this.$store.dispatch("fetchBarData",{slug:t.slug,geojson:e,enable:t.analysisConfig.barChart,barRange:t.analysisConfig.barRange}))}))}}},methods:{}},Ra=Ma,Za=a(4227),Va=a(1759),Ia=a(4319),Oa=a(5547),Ba=a(1208),Na=(0,p.Z)(Ra,Rt,Zt,!1,null,null,null),Pa=Na.exports;m()(Na,{VIcon:v.Z,VTab:Za.Z,VTabItem:Va.Z,VTabs:Ia.Z,VTabsItems:Oa.Z,VTabsSlider:Ba.Z});var za={name:"Analysis",components:{DatasetTabs:Pa}},ja=za,Ga=(0,p.Z)(ja,Lt,Mt,!1,null,"5b772d94",null),Ua=Ga.exports,Ya={name:"Desktop",components:{Map:at,AdminConfig:Dt,Analysis:Ua},computed:{...(0,l.rn)({showMap:e=>e.ui.showMap,showAnalysis:e=>e.ui.showAnalysis})}},Fa=Ya,Wa=(0,p.Z)(Fa,W,q,!1,null,"52dc7a70",null),qa=Wa.exports;m()(Wa,{VCol:ye.Z,VRow:ve.Z});var Ha=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-row",{staticStyle:{height:"100%"},attrs:{"no-gutters":""}},[a("v-col",{directives:[{name:"show",rawName:"v-show",value:1==e.showAnalysis,expression:"showAnalysis == true"}],staticClass:"overflow-auto analysisContainer",staticStyle:{height:"93vh"},attrs:{sm:"12",md:"6",lg:"7",xl:"6"}},[a("v-row",{staticClass:"grey lighten-4",staticStyle:{"min-height":"300px"},attrs:{"no-gutters":""}},[a("v-col",{staticClass:"lighten-5 px-6 py-6",attrs:{cols:"12","data-tour-step":"1"}},[a("AdminConfig")],1)],1),a("v-row",{staticClass:"grey darken-4",attrs:{"no-gutters":""}},[a("v-col",{staticClass:"px-4 py-3",attrs:{cols:"12"}},[a("Analysis",{attrs:{"data-tour-step":"3"}})],1)],1)],1),a("v-col",{directives:[{name:"show",rawName:"v-show",value:1==e.showMap,expression:"showMap == true"}],ref:"mapContainer",staticClass:"mapContainer grey darken-3",staticStyle:{"min-width":"100px","max-width":"100%",height:"auto"}},[a("Map")],1)],1)},Ja=[],Qa={name:"Mobile",components:{Map:at,AdminConfig:Dt,Analysis:Ua},computed:{...(0,l.rn)({showMap:e=>e.ui.showMap,showAnalysis:e=>e.ui.showAnalysis})}},Ka=Qa,Xa=(0,p.Z)(Ka,Ha,Ja,!1,null,null,null),eo=Xa.exports;m()(Xa,{VCol:ye.Z,VRow:ve.Z});var to={name:"Dashboard",components:{Mobile:eo,Desktop:qa},computed:{...(0,l.rn)({isMobile:e=>e.ui.isMobile})},created(){window.innerWidth<=768?this.$store.dispatch("toggleMobile",{isMobile:!0}):this.$store.dispatch("toggleMobile",{isMobile:!1})},mounted(){addEventListener("resize",(()=>{window.innerWidth<=768?this.$store.dispatch("toggleMobile",{isMobile:!0}):this.$store.dispatch("toggleMobile",{isMobile:!1})}))}},ao=to,oo=(0,p.Z)(ao,Y,F,!1,null,null,null),so=oo.exports;o.Z.use(U.Z);const io=[{path:"/",name:"dashboard",component:so}],ro=new U.Z({mode:"history",base:"/dash/",routes:io});var no=ro,lo=a(9132);o.Z.use(lo.Z);var co=new lo.Z({}),po=a(9057),uo=a.n(po);const mo=()=>({boundaries:{iso:"IGAD",type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[20.6103515625,-12.039320557540572],[51.943359375,-12.039320557540572],[51.943359375,22.755920681486405],[20.6103515625,22.755920681486405],[20.6103515625,-12.039320557540572]]]}}]},countryNames:[{id:"BDI",name:"Burundi"},{id:"DJI",name:"Djibouti"},{id:"ERI",name:"Eritrea"},{id:"ETH",name:"Ethiopia"},{id:"KEN",name:"Kenya"},{id:"RWA",name:"Rwanda"},{id:"SOM",name:"Somalia"},{id:"SSD",name:"South Sudan"},{id:"SDN",name:"Sudan"},{id:"TZA",name:"Tanzania"},{id:"UGA",name:"Uganda"}],regionNames:[],subRegionNames:[],selectedCountry:null,selectedRegion:null,selectedSubRegion:null}),ho={state:mo(),getters:{getCountry(e){return e.selectedCountry},getBoundaries(e){return e.boundaries},selectedPlaces(e){return{country:e.selectedCountry,region:e.selectedRegion,subregion:e.selectedSubRegion}}},mutations:{SET_BOUNDARY:(e,t)=>e.boundaries=t,SET_REGION_NAMES:(e,t)=>e.regionNames=t,SET_SUBREGION_NAMES:(e,t)=>e.subRegionNames=t,UPDATE_COUNTRY:(e,t)=>e.selectedCountry=t,UPDATE_REGION:(e,t)=>e.selectedRegion=t,UPDATE_SUBREGION:(e,t)=>e.selectedSubRegion=t,RESET_BOUNDARY(e){Object.assign(e,mo())}},actions:{fetchBoundaries:async({dispatch:e,commit:t},a)=>{try{let o="",s=a.country;if(1===a.level&&s)o=s;else if(2===a.level&&a.region){let e=a.region.split(".");o=`${e[0]}/${e[1].split("_")[0]}`}else if(3===a.level&&a.subregion){let e=a.subregion.split(".");o=`${e[0]}/${e[1]}/${e[2].split("_")[0]}`}const i=await fetch(`https://eahazardswatch.icpac.net/api/geostore/admin/${o}?thresh=0.005`),r=await i.json();await e("fetchAdminNames",{country:a.country,level:a.level,region:a.region}),t("SET_BOUNDARY",r.data.attributes.geojson)}catch(o){return console.log(o)}},fetchAdminNames:async({commit:e},t)=>{try{const a="https://eahazardswatch.icpac.net/pg/featureserv/functions";if(1===t.level){const o=await fetch(`${a}/ea_adm${t.level}_list/items.json?country_iso=${t.country}`),s=await o.json();e("SET_REGION_NAMES",s)}else if(2===t.level){const o=await fetch(`${a}/ea_adm${t.level}_list/items.json?country_iso=${t.country}&adm1=${t.region}`),s=await o.json();e("SET_SUBREGION_NAMES",s)}}catch(a){return console.log(a)}},resetBoundary({commit:e}){e("RESET_BOUNDARY")}}};var go=ho;const yo={state:()=>({isDual:!1}),getters:{},mutations:{TOGGLE_DUAL:e=>(e.isDual=!e.isDual,e.isDual)},actions:{toggleDual:async({commit:e})=>{e("TOGGLE_DUAL")}}};var bo=yo;const fo={state:()=>({datasets:[],loading:!0}),getters:{},mutations:{SET_DATASETS:(e,t)=>e.datasets=t,SET_LOADING:e=>e.loading=!1},actions:{fetchDatasets:async e=>{try{const t=await fetch("https://grace-amondi.github.io/dash/db.json"),a=await t.json();e.commit("SET_DATASETS",a["datasets"])}catch(t){return console.error(t)}}}};var vo=fo;const _o=(e,t,a,o={})=>{const s=6378137*Math.PI*2,i=e/360*s,r=Math.sin(t*Math.PI/180),n=.25*Math.log((1+r)/(1-r))/Math.PI*s,l=i-50+","+(n-50)+","+(i+50)+","+(n+50),c={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,WIDTH:256,HEIGHT:256,CRS:"EPSG:3857",STYLES:"",INFO_FORMAT:"application/json",...o,BBOX:l,I:128,J:128},d=Object.keys(c).map((e=>`${e}=${c[e]}`)).join("&");return`${a}?${d}`};var So=[{id:"ea_boundaries",dataset:"ea_boundaries",name:"Admin Boundaries",layer:"ea_boundaries",isBoundary:!0,layers:[{isBoundary:!0,tableName:"pgadapter.ea_gadm36_political_boundaries",name:"Admin Boundaries",id:"pgadapter.ea_gadm36_political_boundaries",description:"East Africa Boundaries",default:!0,visible:!0,layerConfig:{type:"vector",source:{tiles:["https://eahazardswatch.icpac.net/pg/tileserv/pgadapter.ea_gadm36_political_boundaries/{z}/{x}/{y}.pbf"],type:"vector"},render:{layers:[{id:"level-0-fill",filter:["==","level",0],maxzoom:3.5,paint:{"fill-color":"#ffffff","fill-opacity":0},"source-layer":"pgadapter.ea_gadm36_political_boundaries",source:"pgadapter.ea_gadm36_political_boundaries",type:"fill"},{id:"level-0-line",filter:["==","level",0],paint:{"line-color":"#7f7f7f","line-opacity":.7,"line-width":.7},"source-layer":"pgadapter.ea_gadm36_political_boundaries",source:"pgadapter.ea_gadm36_political_boundaries",type:"line"},{id:"level-1-fill",filter:["==","level",1],minzoom:4,maxzoom:7,paint:{"fill-color":"#ffffff","fill-opacity":0},"source-layer":"pgadapter.ea_gadm36_political_boundaries",source:"pgadapter.ea_gadm36_political_boundaries",type:"fill"},{id:"level-1-line",filter:["==","level",1],minzoom:5,paint:{"line-color":"#7f7f7f","line-opacity":.3,"line-width":.7},"source-layer":"pgadapter.ea_gadm36_political_boundaries",source:"pgadapter.ea_gadm36_political_boundaries",type:"line"},{id:"level-2-fill",filter:["==","level",2],minzoom:7,paint:{"fill-color":"#ffffff","fill-opacity":0},"source-layer":"pgadapter.ea_gadm36_political_boundaries",source:"pgadapter.ea_gadm36_political_boundaries",type:"fill"},{id:"level-2-line",filter:["==","level",2],minzoom:7,paint:{"line-color":"#f1f1f1","line-opacity":.4,"line-dasharray":[2,4],"line-width":.5},"source-layer":"pgadapter.ea_gadm36_political_boundaries",source:"pgadapter.ea_gadm36_political_boundaries",type:"line"}]}},interactionConfig:{output:[{column:"gid_0",format:null,property:"ISO",type:"string"}],type:"intersection"}}]}];const Co=[...So],wo={state:()=>({layers:[],layerConfig:{type:"raster",tiles:[],minzoom:2,maxzoom:12,tileSize:256},allLayers:[],infoUrl:"",featureInfo:null}),getters:{getActiveLayers:e=>e.layers},mutations:{RESET_CONFIG:e=>(Object.assign(e,{layerConfig:{type:"raster",tiles:[],minzoom:2,maxzoom:12,tileSize:256}}),e.layerConfig),SET_CONFIG:(e,t)=>{let a=e.layers.find((e=>e.id===t.id));return a&&(e.layerConfig.tiles[0]=a.layerConfig.tiles[0],Object.keys(a.params).forEach((t=>{e.layerConfig.tiles[0]=e.layerConfig.tiles[0].replace(`{${t}}`,a.params[t])}))),e.layerConfig},SET_LAYERS:e=>{let t=[];return e.dataset.datasets=Co.concat(e.dataset.datasets),e.dataset.datasets.map((e=>{t.push(e.layers)})),e.layers=Array.prototype.concat(...t),e.layers.map((e=>{if(!e?.isBoundary){let t=e.layerConfig.tiles[0];Object.keys(e.params).forEach((a=>{t=t.replace(`{${a}}`,e.params[a])})),e["parsedConfig"]={type:"raster",tiles:[t],minzoom:2,maxzoom:12,tileSize:256}}})),e.layers},SET_PARAMS:(e,t)=>{let a=e.layers.findIndex((e=>e.id===t.id));return Object.assign(e.layers[a].params,t.params),e.layers},SET_BAR_RANGE:(e,t)=>(e.layers.find((e=>e.id===t.id)).analysisConfig.barRange=t.barRange,e.layers),TOGGLE_LAYER_VISIBILITY:(e,t)=>{const a=e.layers.find((e=>e.id===t.layerId)),o=e.layers.findIndex((e=>e.id===t.layerId));if(a)return e.layers.splice(o,1),e.layers.splice(1,0,a),a.visible=!a.visible},SET_FEATURE_INFO_URL:(e,t)=>{let a=e.layers[0],o=t.lat,s=t.lng;const i=a.params,{params:r,url:n}=a?.wmsConfig||{},l={};return Object.keys(r).forEach((e=>{i[r[e]]?l[e]=i[r[e]]:l[e]=r[e]})),e.infoUrl=_o(s,o,n,l),e.infoUrl},SET_FEATURE_INFO:(e,t)=>{e.featureInfo=t.featureInfo}},actions:{setLayers:async({dispatch:e,commit:t})=>{await e("fetchDatasets"),await t("SET_LAYERS"),t("SET_LOADING")},toggleLayerVisibility:async({commit:e},t)=>{e("TOGGLE_LAYER_VISIBILITY",t)},resetConfig:async({commit:e},t)=>{e("RESET_CONFIG",t)},setConfig:async({dispatch:e,commit:t},a)=>{await e("resetConfig"),t("SET_CONFIG",a)},setParams:async({dispatch:e,commit:t},a)=>{await t("SET_PARAMS",a),e("setConfig",a)},setBarRange:async({commit:e},t)=>{e("SET_BAR_RANGE",t)},setFeatureInfoUrl:async({commit:e},t)=>{e("SET_FEATURE_INFO_URL",t)},setFeatureInfo:async({commit:e},t)=>{try{const a=await fetch(t.infoUrl),o=await a.json();e("SET_FEATURE_INFO",{featureInfo:o.features&&!!o.features.length&&o.features[0]})}catch(a){console.log(a)}}},modules:{dataset:vo}};var xo=wo;const To={state:()=>({theme:{color:["#fc97af","#87f7cf","#f7f494","#72ccff","#f7c5a0","#d4a4eb","#d2f5a6","#76f2f2"],backgroundColor:"#1e1e1e",textStyle:{width:"5"},title:{textStyle:{color:"#f5f5f5"},subtextStyle:{color:"#dddddd"}},line:{itemStyle:{borderWidth:"4"},lineStyle:{width:"3"},symbolSize:"0",symbol:"roundRect",smooth:!0},radar:{itemStyle:{borderWidth:"4"},lineStyle:{width:"3"},symbolSize:"0",symbol:"roundRect",smooth:!0},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#fc97af",color0:"transparent",borderColor:"#fc97af",borderColor0:"#87f7cf",borderWidth:"2"}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:"1",color:"#ffffff"},symbolSize:"0",symbol:"roundRect",smooth:!0,color:["#fc97af","#87f7cf","#f7f494","#72ccff","#f7c5a0","#d4a4eb","#d2f5a6","#76f2f2"],label:{color:"#293441"}},map:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#999999",borderWidth:.5},label:{color:"#893448"},emphasis:{itemStyle:{areaColor:"rgba(255,178,72,1)",borderColor:"#eb8146",borderWidth:1},label:{color:"rgb(137,52,72)"}}},geo:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#999999",borderWidth:.5},label:{color:"#893448"},emphasis:{itemStyle:{areaColor:"rgba(255,178,72,1)",borderColor:"#eb8146",borderWidth:1},label:{color:"rgb(137,52,72)"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#919191"}},axisTick:{show:!0,lineStyle:{color:"#d8d8d8"}},axisLabel:{show:!0,color:"#c9c9c9"},splitLine:{show:!1,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#919191"}},axisTick:{show:!0,lineStyle:{color:"#d8d8d8"}},axisLabel:{show:!0,color:"#c9c9c9"},splitLine:{show:!1,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#919191"}},axisTick:{show:!0,lineStyle:{color:"#d8d8d8"}},axisLabel:{show:!0,color:"#c9c9c9"},splitLine:{show:!1,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#919191"}},axisTick:{show:!0,lineStyle:{color:"#d8d8d8"}},axisLabel:{show:!0,color:"#c9c9c9"},splitLine:{show:!1,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#bbbbbb"}},tooltip:{axisPointer:{lineStyle:{color:"#f1f1f1",width:1},crossStyle:{color:"#f1f1f1",width:1}}},timeline:{lineStyle:{color:"#87f7cf",width:1},itemStyle:{color:"#87f7cf",borderWidth:1},controlStyle:{color:"#87f7cf",borderColor:"#87f7cf",borderWidth:.5},checkpointStyle:{color:"#fc97af",borderColor:"#fc97af"},label:{color:"#87f7cf"},emphasis:{itemStyle:{color:"#f7f494"},controlStyle:{color:"#87f7cf",borderColor:"#87f7cf",borderWidth:.5},label:{color:"#87f7cf"}}},visualMap:{color:["#fc97af","#87f7cf"]},dataZoom:{backgroundColor:"rgba(255,255,255,0)",dataBackgroundColor:"rgba(114,204,255,1)",fillerColor:"rgba(114,204,255,0.2)",handleColor:"#72ccff",handleSize:"100%",textStyle:{color:"#333333"}},markPoint:{label:{color:"#293441"},emphasis:{label:{color:"#293441"}}}},barData:[],pieData:[],barLoading:!0,pieLoading:!0}),getter:{},mutations:{SET_BAR_DATA:(e,t)=>e.barData=t,SET_PIE_DATA:(e,t)=>e.pieData=t,SET_BAR_LOADING:(e,t)=>(e.barLoading=t,e.barLoading),SET_PIE_LOADING:(e,t)=>(e.pieLoading=t,e.pieLoading)},actions:{fetchBarData:async({commit:e},t)=>{e("SET_BAR_LOADING",!0);try{if(t.enable){const a=await fetch(`https://eahazardswatch.icpac.net/pg-gridapi/api/analysis/${t.slug}?start_year=${t.barRange[0]}&end_year=${t.barRange[1]}&ts=true`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({geojson:t.geojson})}),o=await a.json();await e("SET_BAR_DATA",o),e("SET_BAR_LOADING",!1)}}catch(a){console.log(a)}},fetchPieData:async({commit:e},t)=>{e("SET_PIE_LOADING",!0);try{if(t.enable){const a=await fetch(`https://eahazardswatch.icpac.net/pg-gridapi/api/analysis/${t.slug}?year=${t.date.selectedYear}&month=${t.date.selectedMonth}&tenday=${t.date.selectedTenDays}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({geojson:t.geojson})}),o=await a.json();await e("SET_PIE_DATA",o),e("SET_PIE_LOADING",!1)}}catch(a){console.log(a)}}}};var Eo=To;const ko={state:()=>({isMobile:!1,showMap:!1,showAnalysis:!0}),getters:{},mutations:{TOGGLE_MOBILE:(e,t)=>(e.isMobile=t.isMobile,e.isMobile),TOGGLE_MAP_ANALYSIS:e=>{e.showMap=!e.showMap,e.showAnalysis=!e.showAnalysis}},actions:{toggleMobile:async({commit:e},t)=>{e("TOGGLE_MOBILE",t)},toggleMapAnalysis:async({commit:e})=>{e("TOGGLE_MAP_ANALYSIS")}}};var Ao=ko;o.Z.use(l.ZP);const $o=new l.ZP.Store({modules:{boundary:go,mapContainer:bo,dataset:vo,layer:xo,chart:Eo,ui:Ao}});a(8942);o.Z.config.productionTip=!1,o.Z.config.devtools=!0,o.Z.use(uo()),new o.Z({router:no,vuetify:co,store:$o,render:e=>e(G)}).$mount("#app")}},t={};function a(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,a),i.exports}a.m=e,function(){var e=[];a.O=function(t,o,s,i){if(!o){var r=1/0;for(d=0;d<e.length;d++){o=e[d][0],s=e[d][1],i=e[d][2];for(var n=!0,l=0;l<o.length;l++)(!1&i||r>=i)&&Object.keys(a.O).every((function(e){return a.O[e](o[l])}))?o.splice(l--,1):(n=!1,i<r&&(r=i));if(n){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[o,s,i]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};a.t=function(o,s){if(1&s&&(o=this(o)),8&s)return o;if("object"===typeof o&&o){if(4&s&&o.__esModule)return o;if(16&s&&"function"===typeof o.then)return o}var i=Object.create(null);a.r(i);var r={};e=e||[null,t({}),t([]),t(t)];for(var n=2&s&&o;"object"==typeof n&&!~e.indexOf(n);n=t(n))Object.getOwnPropertyNames(n).forEach((function(e){r[e]=function(){return o[e]}}));return r["default"]=function(){return o},a.d(i,r),i}}(),function(){a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,i,r=o[0],n=o[1],l=o[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(s in n)a.o(n,s)&&(a.m[s]=n[s]);if(l)var d=l(a)}for(t&&t(o);c<r.length;c++)i=r[c],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(d)},o=self["webpackChunkdash"]=self["webpackChunkdash"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=a.O(void 0,[998],(function(){return a(3969)}));o=a.O(o)})();
//# sourceMappingURL=app.ba4ebaa5.js.map